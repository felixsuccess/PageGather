# 读书记录应用实现任务列表

## 🚀 P0 - 基础架构搭建 (已完成)

- [x] 1. 创建 Android 项目基础结构

  - 创建新的 Android 项目，配置 Jetpack Compose 和 Material 3
  - 设置项目包结构（presentation、domain、data 分层）
  - 配置 build.gradle 依赖项（Hilt、Room、Coil 等）
  - _需求: 技术架构基础_

- [x] 2. 配置依赖注入和数据库

  - 集成 Hilt 依赖注入框架
  - 创建 Room 数据库配置和基础 Entity 类
  - 实现错误处理和文件管理系统
  - _需求: 架构组件设置_

- [x] 3. 创建 Domain 层基础架构

  - 创建 domain 包结构（entity、repository、usecase）
  - 定义 Repository 接口（BookRepository、NoteRepository、ReadingRecordRepository）
  - 创建通用的 Result 类和错误处理机制
  - _需求: Clean Architecture 实现_

- [x] 4. 创建 Material 3 主题和基础组件

  - 实现应用主题配置（浅色/深色模式）
  - 创建自定义颜色、字体、间距系统
  - 实现基础 UI 组件和导航配置
  - _需求: 6 - 用户界面和体验_

- [x] 5. 实现主界面和导航

  - 创建主界面布局和导航结构
  - 实现底部导航栏和路由管理
  - 创建启动页面和基础界面框架
  - _需求: 整体用户体验_

## 🚀 P0 - 界面驱动开发 (核心功能)

### ✅ 第一阶段：书籍管理功能（已完成）

- [x] 6. 书籍管理功能完整实现

  **界面层实现：**

  - ✅ 书籍列表界面（BookListScreen）- 显示、搜索、分页加载
  - ✅ 书籍详情页面（BookDetailScreen）- 完整信息展示、沉浸式设计
  - ✅ 添加/编辑界面（BookEditScreen）- 完整表单、验证、封面管理
  - ✅ 封面管理功能 - 相册选择、拍照、本地存储、网络加载

  **数据层实现：**

  - ✅ BookRepository 完整实现 - CRUD、搜索、排序、分页、关联管理
  - ✅ BookDao 和相关实体类完整实现
  - ✅ 图片存储和缓存逻辑完整实现

  - _需求: 1, 1.2 - 书籍管理系统基础功能_

### 第二阶段：分组和标签管理功能

- [x] 7. 分组管理功能实现

  **界面层：**

  - 创建分组管理界面，支持分组的 CRUD 操作
  - 实现书籍与分组的关联编辑功能
  - 在书籍列表中添加分组筛选功能
  - 在书籍编辑页面添加分组选择功能

  **数据层：**

  - 完善 BookGroupRepository 的功能实现
  - 实现分组与书籍的关联管理
  - 添加分组相关的查询和统计功能

  - _需求: 1.1 - 分组管理功能_

- [x] 8. 标签管理功能实现

  **界面层：**

  - ✅ 创建标签管理界面，支持标签的 CRUD 操作
  - ✅ 实现书籍与标签的关联编辑功能
  - ✅ 实现笔记与标签的关联编辑功能  
  - ✅ 在书籍编辑页面添加标签选择功能
  - ✅ 在笔记编辑页面添加标签选择功能 

  **数据层：**

  - ✅ 完善 TagRepository 的功能实现
  - ✅ 实现标签与书籍、笔记的关联管理
  - ✅ 创建 NoteTagRefDao 和完整的 CRUD 操作
  - ✅ 添加标签相关的查询和统计功能

  _完成状态：已实现完整的标签管理功能，包括组件复用优化（TagSelector通用化、BookTagSelector和NoteTagSelector包装器）和代码清理优化（移除冗余Screen定义、优化代码结构）_

  - _需求: 1.1, 3.3 - 标签管理功能_

### 第三阶段：阅读记录和计时功能

- [ ] 9. 阅读计时功能实现

  **界面层：**

  - 创建正向和反向计时器界面
  - 实现后台计时和通知栏显示
  - 实现计时数据的自动保存和阅读记录
  - 添加休息提醒和计时历史功能

  **数据层：**

  - 完善 ReadingRecordRepository 的 CRUD 操作
  - 实现阅读记录的统计查询功能
  - 添加计时相关的数据处理逻辑

  - _需求: 2.1 - 阅读计时功能_

- [ ] 10. 阅读记录管理功能实现

  **界面层：**

  - 创建阅读历史查看界面
  - 实现阅读记录的编辑和删除功能
  - 添加阅读统计展示界面
  - 实现阅读记录的筛选和导出功能

  **数据层：**

  - 完善阅读记录的查询和筛选功能
  - 实现阅读统计数据的计算逻辑
  - 添加数据导出功能

  - _需求: 2.2, 2.3 - 阅读记录和历史_

### 第四阶段：笔记管理功能（数据层已完成）

- [ ] 11. 笔记管理功能完善

  **界面层：**

  - 完善笔记列表界面，添加搜索和筛选功能
  - 完善笔记编辑界面，支持 Markdown 和附件管理
  - 创建笔记详情展示界面，支持富文本渲染
  - 添加书摘管理功能

  **业务逻辑层：**

  - 创建笔记 CRUD 相关 Use Cases
  - 实现 Markdown 处理和图片管理 Use Cases
  - 创建笔记搜索和标签管理 Use Cases

  - _需求: 3, 3.2, 3.3, 3.4, 3.5 - 笔记系统_

### 第五阶段：统计分析功能

- [ ] 12. 统计分析功能实现

  **界面层：**

  - 创建统计概览界面，显示基础阅读数据
  - 实现阅读时间线界面，展示阅读历程
  - 创建图表界面，显示阅读趋势和分析
  - 实现热力图和日历视图

  **数据层：**

  - 创建 Achievement 实体和 DAO，支持勋章系统
  - 创建 ReadingGoal 实体和 DAO，支持阅读目标管理
  - 实现统计相关的 Repository 和查询方法

  **业务逻辑层：**

  - 实现统计数据计算 Use Cases
  - 创建勋章解锁逻辑 Use Cases
  - 实现阅读目标管理 Use Cases

  - _需求: 4, 4.1, 4.2, 5 - 统计分析和勋章系统_

### 第六阶段：高级功能和优化

- [ ] 13. 书籍筛选和排序功能实现

  **界面层：**

  - 在书籍列表中添加筛选和排序 UI
  - 实现按状态、分组、标签、来源的筛选功能
  - 实现按时间、标题、进度、评分的排序功能

  **业务逻辑层：**

  - 创建 SearchBooksUseCase 和书籍筛选逻辑
  - 实现复合筛选条件的处理逻辑
  - 优化查询性能

  - _需求: 1.1.5, 1.1.6, 1.3.5 - 筛选和排序功能_

## 🚀 P0 - 数据完整性和初始化

- [x] 22. 完善书籍数据模型和数据库结构

  - 验证现有实体：BookGroupEntity（书籍分组）、BookSourceEntity（来源）、TagEntity（标签）已存在
  - 验证关联表实体：BookGroupRefEntity（书籍分组关联）、BookTagRefEntity（书籍标签关联）、NoteTagRefEntity（笔记标签关联）已存在
  - 创建缺失的 DAO：BookGroupDao、TagDao、BookSourceDao
  - 根据设计文档更新 BookEntity（基础书籍信息）
  - 更新数据库版本和迁移脚本
  - _需求: 1, 1.1, 1.3 - 书籍管理系统_

- [ ] 23. 实现应用数据初始化

  - 在 Application 类中实现应用启动时的数据初始化
  - 初始化内置书籍来源（微信读书、Kindle、实体书等）
  - 初始化默认分组和标签（如果需要）
  - 实现数据库版本迁移和数据完整性检查
  - _需求: 应用基础数据管理_

- [ ] 24. 添加数据验证和错误处理机制

  - 实现输入数据验证
  - 添加统一的错误处理流程
  - _需求: 1, 2, 3 - 整体系统稳定性_

- [x] 25. 完善笔记数据层实现

  - 根据设计文档更新 NoteEntity，支持个人想法和原文摘录分离（idea、quote）
  - 完善 NoteAttachment 实体，支持多种附件类型和内嵌图片标记
  - 创建 NoteAttachmentDao 和相关查询方法
  - 完善 NoteDao 和 NoteRepository，添加附件管理和搜索功能
  - _需求: 3, 3.2, 3.3, 3.5 - 笔记和书摘系统_

## 🚀 P0 - 功能测试和质量保证

- [ ] 26. 编写界面功能测试

  - 测试书籍管理界面的用户交互
  - 测试笔记管理界面的编辑功能
  - 测试阅读计时界面的计时功能
  - _需求: 用户体验质量_

- [ ] 27. 编写数据层单元测试

  - 为 BookRepository 编写单元测试
  - 为 NoteRepository 编写单元测试
  - 为 ReadingRecordRepository 编写单元测试
  - _需求: 代码质量保证_

- [ ] 28. 编写业务逻辑层单元测试

  - 为书籍管理 Use Cases 编写单元测试
  - 为阅读记录 Use Cases 编写单元测试
  - 为笔记管理 Use Cases 编写单元测试
  - _需求: 代码质量保证_

## 🎯 P1 - 高级功能实现 (重要功能)

- [ ] 29. 实现 ISBN 处理功能（离线部分）

  - 实现 ISBN 格式验证
  - 添加手动输入 ISBN 的备选方案
  - _需求: 1 - ISBN 支持_

- [ ] 30. 集成在线图书数据库 API

  - 集成豆瓣图书 API
  - 集成 Google Books API
  - 实现 API 调用封装和错误处理
  - 添加网络状态检测和重试机制
  - _需求: 1 - 在线书籍信息获取_

- [ ] 31. 实现书籍信息自动获取功能

  - 根据 ISBN 或书名自动获取书籍详细信息
  - 实现书籍封面下载和缓存逻辑
  - _需求: 1 - 在线书籍信息获取_

- [ ] 32. 实现 ISBN 扫描功能

  - 集成 CameraX 和 ML Kit 进行条形码扫描
  - 实现扫描结果处理和 ISBN 提取
  - _需求: 1 - ISBN 支持_

- [ ] 33. 实现勋章系统

  - 创建勋章展示界面
  - 实现勋章解锁逻辑和通知
  - 创建勋章分享功能
  - 实现勋章进度跟踪
  - _需求: 5 - 读书勋章系统_

- [ ] 34. 编写集成测试

  - 测试数据层与业务逻辑层交互
  - 测试业务逻辑层与 UI 层交互
  - 测试跨模块功能流程
  - _需求: 系统集成质量_

## 🌟 P2 - 增强功能 (体验优化)

- [ ] 35. 实现应用设置

  - 创建设置界面的分类布局
  - 实现主题切换和字体大小调节
  - 实现通知设置和权限管理
  - 添加数据备份和导入导出功能
  - _需求: 7, 9 - 应用设置与个性化_

- [ ] 36. 实现网络状态检测和离线模式

  - 添加网络连接状态实时检测
  - 实现离线工作模式
  - _需求: 1 - 在线书籍信息获取_

- [ ] 37. 实现数据同步功能（可选）
  - 实现书籍、笔记和阅读记录的本地数据与云端同步
  - 支持增量同步和全量同步两种方式
  - 实现定时同步（默认每天凌晨 2 点）和手动触发同步功能
  - 添加网络状态检测，仅在 WiFi 环境下自动同步
  - 实现同步冲突解决策略（默认本地数据优先）
  - 添加同步状态提示和历史记录
  - \_需求: 数据同步功能

## 🌟 P2 - 性能测试和优化

- [ ] 38. 性能测试和优化

  - 优化数据库查询和图片缓存
  - 测试应用启动时间和内存占用
  - 实现性能监控和崩溃报告
  - _需求: 用户体验质量_

## 🎁 P3 - 附加功能

- [ ] 39. 创建个人藏书管理数据模型

  - 创建 BookCollectionEntity 实体，添加藏书管理字段（ownershipStatus、storageLocation、bookCondition、wishlistPriority、wishlistNotes）
  - _需求: 8 - 个人藏书管理_

- [ ] 40. 实现个人藏书管理界面

  - 基于 BookCollectionEntity 实现藏书管理界面，添加拥有状态和存放位置管理
  - _需求: 8.1 - 藏书管理界面_

- [ ] 41. 实现藏书借阅数据层

  - 创建 LendingRecord 实体类（包含借阅人、借阅日期、归还日期、借阅状态等字段）
  - 实现 LendingRecordDao，提供借阅记录的 CRUD 操作
  - 实现与 BookCollectionEntity 的关联查询
  - 设计数据访问接口，支持借阅记录管理界面调用
  - _归属模块：藏书管理_
  - _需求: 8.2 - 借阅记录管理_

- [ ] 42. 实现借阅记录管理界面

  - 依赖任务 45 实现的借阅数据层，创建借阅记录管理界面
  - _需求: 8.2 - 借阅记录管理_

- [ ] 43. 实现心愿单管理功能

  - 创建心愿单界面和管理功能
  - 实现心愿单优先级管理和备注功能
  - _需求: 8.1 - 藏书管理界面_

- [ ] 44. 创建藏书展示和书单分享功能
  - 实现藏书展示界面
  - 添加书单创建和分享功能
  - _需求: 8.1 - 藏书管理界面_
- [ ] 45. 实现小部件功能

  - 实现书摘漫步小部件，随机展示用户的书摘
  - 实现今日阅读提醒小部件，提醒用户每日阅读计划
  - 支持小部件自定义配置（大小、样式等）
  - _需求: 用户体验优化_

## 🎁 P3 - 系统测试和发布准备

- [ ] 46. 系统测试

  - 端到端测试主要用户流程
  - 兼容性测试不同设备
  - 无障碍测试
  - _需求: 整体系统质量_

- [ ] 47. 应用发布准备
  - 配置应用签名和混淆
  - 优化 APK 大小和启动时间
  - 完善应用图标和启动页
  - 准备应用商店发布材料
  - _需求: 应用发布_
