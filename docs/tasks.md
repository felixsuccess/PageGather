# 读书记录应用实现任务列表

## 🚀 P0 - 基础架构搭建 (已完成)

- [x] 1. 创建 Android 项目基础结构

  - 创建新的 Android 项目，配置 Jetpack Compose 和 Material 3
  - 设置项目包结构（presentation、domain、data 分层）
  - 配置 build.gradle 依赖项（Hilt、Room、Coil 等）
  - _需求: 技术架构基础_

- [x] 2. 配置依赖注入和数据库

  - 集成 Hilt 依赖注入框架
  - 创建 Room 数据库配置和基础 Entity 类
  - 实现错误处理和文件管理系统
  - _需求: 架构组件设置_

- [x] 3. 创建 Domain 层基础架构

  - 创建 domain 包结构（entity、repository、usecase）
  - 定义 Repository 接口（BookRepository、NoteRepository、ReadingRecordRepository）
  - 创建通用的 Result 类和错误处理机制
  - _需求: Clean Architecture 实现_

- [x] 4. 创建 Material 3 主题和基础组件

  - 实现应用主题配置（浅色/深色模式）
  - 创建自定义颜色、字体、间距系统
  - 实现基础 UI 组件和导航配置
  - _需求: 6 - 用户界面和体验_

- [x] 5. 实现主界面和导航

  - 创建主界面布局和导航结构
  - 实现底部导航栏和路由管理
  - 创建启动页面和基础界面框架
  - _需求: 整体用户体验_

## 🚀 P0 - 数据层完善 (核心功能)

- [x] 6. 完善书籍数据模型和数据库结构

  - 验证现有实体：BookGroupEntity（书籍分组）、BookSourceEntity（来源）、TagEntity（标签）已存在
  - 验证关联表实体：BookGroupRefEntity（书籍分组关联）、BookTagRefEntity（书籍标签关联）、NoteTagRefEntity（笔记标签关联）已存在
  - 创建缺失的 DAO：BookGroupDao、TagDao、BookSourceDao
  - 根据设计文档更新 BookEntity（基础书籍信息）
  - 更新数据库版本和迁移脚本
  - _需求: 1, 1.1, 1.3 - 书籍管理系统_

- [ ] 7. 完善 BookRepository

  - 添加书籍排序支持
  - 实现书籍与分组、标签、来源的关联管理
  - _需求: 1, 1.1 - 书籍管理功能_

- [ ] 8. 实现 BookGroupRepository

  - 实现分组的 CRUD 操作
  - 实现分组与书籍的关联管理
  - _需求: 1.1 - 书籍分组功能_

- [ ] 9. 实现 TagRepository

  - 实现标签的 CRUD 操作
  - 实现标签与书籍、笔记的关联管理
  - _需求: 1.1, 3.3 - 标签管理功能_

- [ ] 10. 实现 BookSourceRepository

  - 实现书籍来源的 CRUD 操作
  - _需求: 1.1 - 书籍来源管理功能_

- [ ] 11. 完善 ReadingRecordRepository

  - 添加统计查询功能
  - 实现阅读记录功能
  - _需求: 2, 2.1, 2.2, 2.3 - 阅读记录和计时_

- [ ] 12. 添加数据验证和错误处理机制

  - 实现输入数据验证
  - 添加统一的错误处理流程
  - _需求: 1, 2, 3 - 整体系统稳定性_

- [x] 13. 完善笔记数据层实现

  - 根据设计文档更新 NoteEntity，支持个人想法和原文摘录分离（idea、quote）
  - 完善 NoteAttachment 实体，支持多种附件类型和内嵌图片标记
  - 创建 NoteAttachmentDao 和相关查询方法
  - 完善 NoteDao 和 NoteRepository，添加附件管理和搜索功能
  - _需求: 3, 3.2, 3.3, 3.5 - 笔记和书摘系统_

- [ ] 14. 实现统计和目标数据层
  - 创建 Achievement 实体和 DAO，支持勋章系统
  - 创建 ReadingGoal 实体和 DAO，支持阅读目标管理
  - 实现统计相关的 Repository 和查询方法
  - _需求: 4, 4.1, 4.2, 5, 8 - 统计分析和勋章系统_

- [ ] 15. 实现应用数据初始化

  - 在 Application 类中实现应用启动时的数据初始化
  - 初始化内置书籍来源（微信读书、Kindle、实体书等）
  - 初始化默认分组和标签（如果需要）
  - 实现数据库版本迁移和数据完整性检查
  - _需求: 应用基础数据管理_

## 🚀 P0 - 数据层测试

- [ ] 16. 为 BookRepository 编写单元测试

  - _需求: 代码质量保证_

- [ ] 17. 为 NoteRepository 编写单元测试

  - _需求: 代码质量保证_

- [ ] 18. 为 ReadingRecordRepository 编写单元测试

  - _需求: 代码质量保证_

- [ ] 19. 添加数据库操作测试
  - _需求: 代码质量保证_

## 🚀 P0 - 业务逻辑层实现 (核心功能)

- [ ] 20. 实现书籍管理 Use Cases

  - 创建 AddBookUseCase、UpdateBookUseCase、DeleteBookUseCase
  - 实现 SearchBooksUseCase 和书籍筛选逻辑
  - 创建 UpdateBookProgressUseCase 和状态管理 Use Cases
  - 实现分组和标签管理相关 Use Cases
  - _需求: 1, 1.1, 1.2, 1.3, 1.4 - 书籍管理功能_

- [ ] 21. 实现阅读记录 Use Cases

  - 创建 StartReadingRecordUseCase、EndReadingRecordUseCase
  - 实现阅读计时器相关 Use Cases（StartTimerUseCase、PauseTimerUseCase）
  - 创建阅读历史查询和统计 Use Cases
  - 实现阅读目标管理 Use Cases
  - _需求: 2, 2.1, 2.2, 2.3 - 阅读记录和计时_

- [ ] 22. 实现笔记管理 Use Cases
  - 创建笔记 CRUD 相关 Use Cases（AddNoteUseCase、UpdateNoteUseCase、DeleteNoteUseCase）
  - 实现 Markdown 处理和图片管理 Use Cases
  - 创建笔记搜索和标签管理 Use Cases
  - 实现书摘管理相关 Use Cases
  - _需求: 3, 3.2, 3.3, 3.4, 3.5 - 笔记系统_

## 🚀 P0 - 业务逻辑层测试

- [ ] 23. 编写业务逻辑层单元测试

  - 为书籍管理 Use Cases 编写单元测试
  - _需求: 代码质量保证_

- [ ] 24. 编写业务逻辑层单元测试

  - 为阅读记录 Use Cases 编写单元测试
  - _需求: 代码质量保证_

- [ ] 25. 编写业务逻辑层单元测试
  - 为笔记管理 Use Cases 编写单元测试
  - _需求: 代码质量保证_

## 🚀 P0 - UI 层实现 (基础界面)

- [ ] 26. 完善书籍管理界面

  - 完善书籍列表界面，添加搜索和筛选功能
  - 完善书籍详情页面，添加进度更新和操作按钮
  - 完善添加/编辑书籍界面，支持所有字段编辑
  - 实现书籍封面展示功能（支持设置好的封面（本地存储封面）和默认封面）
  - 支持从本地相册选择封面图片
  - 支持拍照上传封面图片
  - 支持从网络 URL 加载封面图片（图片保存本地）
  - _需求: 1, 1.2, 1.3, 1.4 - 书籍管理系统_

- [ ] 27. 实现 ISBN 处理功能（离线部分）

  - 实现 ISBN 格式验证
  - 添加手动输入 ISBN 的备选方案
  - _需求: 1 - ISBN 支持_

- [ ] 28. 集成在线图书数据库 API

  - 集成豆瓣图书 API
  - 集成 Google Books API
  - 实现 API 调用封装和错误处理
  - 添加网络状态检测和重试机制
  - _需求: 1 - 在线书籍信息获取_

- [ ] 29. 实现书籍信息自动获取功能

  - 根据 ISBN 或书名自动获取书籍详细信息
  - 实现书籍封面下载和缓存逻辑
  - _需求: 1 - 在线书籍信息获取_

- [ ] 30. 实现 ISBN 扫描功能

  - 集成 CameraX 和 ML Kit 进行条形码扫描
  - 实现扫描结果处理和 ISBN 提取
  - _需求: 1 - ISBN 支持_

- [ ] 31. 实现分组管理功能

  - 创建分组管理界面，支持分组的 CRUD 操作
  - 实现书籍与分组的关联编辑功能
  - _需求: 1.1 - 分组管理功能_

- [ ] 32. 实现标签管理功能

  - 创建标签管理界面，支持标签的 CRUD 操作
  - 实现书籍与标签的关联编辑功能
  - 实现笔记与标签的关联编辑功能
  - _需求: 3.3 - 标签管理功能_

- [ ] 33. 实现阅读计时功能

  - 创建正向和反向计时器界面
  - 实现后台计时和通知栏显示
  - 实现计时数据的自动保存和阅读记录
  - 添加休息提醒和计时历史功能
  - _需求: 2.1 - 阅读计时功能_

- [ ] 34. 实现统计分析界面

  - 创建统计概览界面，显示基础阅读数据
  - 实现阅读时间线界面，展示阅读历程
  - 创建图表界面，显示阅读趋势和分析
  - 实现热力图和日历视图
  - _需求: 4, 4.1, 4.2 - 统计分析_

- [ ] 35. 完善笔记管理界面

  - 完善笔记列表界面，添加搜索和筛选功能
  - 完善笔记编辑界面，支持 Markdown 和附件管理
  - 创建笔记详情展示界面，支持富文本渲染
  - 添加书摘管理功能
  - _需求: 3, 3.2, 3.3, 3.4, 3.5 - 笔记系统_

- [ ] 36. 实现勋章系统

  - 创建勋章展示界面
  - 实现勋章解锁逻辑和通知
  - 创建勋章分享功能
  - 实现勋章进度跟踪
  - _需求: 5 - 读书勋章系统_

## 🚀 P0 - UI 层测试

- [ ] 37. 编写书籍管理界面 Compose 测试

  - 测试书籍列表展示功能
  - 测试书籍详情页交互
  - 测试书籍搜索和筛选功能
  - _需求: 用户体验质量_

- [ ] 38. 编写笔记管理界面 Compose 测试

  - 测试笔记列表展示功能
  - 测试笔记编辑交互
  - 测试笔记分类功能
  - _需求: 用户体验质量_

- [ ] 39. 编写阅读计时界面 Compose 测试

  - 测试计时启动/暂停/停止功能
  - 测试阅读统计展示
  - 测试阅读目标设置交互
  - _需求: 用户体验质量_

## 🎯 P1 - 完整功能实现 (重要功能)

## 🎯 P1 - 集成测试

- [ ] 40. 编写集成测试

  - 测试数据层与业务逻辑层交互
  - 测试业务逻辑层与 UI 层交互
  - 测试跨模块功能流程
  - _需求: 系统集成质量_

## 🌟 P2 - 增强功能 (体验优化)



- [ ] 41. 实现应用设置

  - 创建设置界面的分类布局
  - 实现主题切换和字体大小调节
  - 实现通知设置和权限管理
  - 添加数据备份和导入导出功能
  - _需求: 7, 9 - 应用设置与个性化_

- [ ] 42. 实现网络状态检测和离线模式

  - 添加网络连接状态实时检测
  - 实现离线工作模式
  - _需求: 1 - 在线书籍信息获取_  

- [ ] 43. 实现数据同步功能（可选）
  - 实现书籍、笔记和阅读记录的本地数据与云端同步
  - 支持增量同步和全量同步两种方式
  - 实现定时同步（默认每天凌晨2点）和手动触发同步功能
  - 添加网络状态检测，仅在WiFi环境下自动同步
  - 实现同步冲突解决策略（默认本地数据优先）
  - 添加同步状态提示和历史记录
  - _需求: 数据同步功能

## 🌟 P2 - 性能测试和优化

- [ ] 44. 性能测试和优化

  - 优化数据库查询和图片缓存
  - 测试应用启动时间和内存占用
  - 实现性能监控和崩溃报告
  - _需求: 用户体验质量_

## 🎁 P3 - 附加功能

- [ ] 45. 创建个人藏书管理数据模型
  - 创建 BookCollectionEntity 实体，添加藏书管理字段（ownershipStatus、storageLocation、bookCondition、wishlistPriority、wishlistNotes）
  - _需求: 8 - 个人藏书管理_

- [ ] 46. 实现个人藏书管理界面
  - 基于 BookCollectionEntity 实现藏书管理界面，添加拥有状态和存放位置管理
  - _需求: 8.1 - 藏书管理界面_

- [ ] 47. 实现藏书借阅数据层
  - 创建 LendingRecord 实体类（包含借阅人、借阅日期、归还日期、借阅状态等字段）
  - 实现 LendingRecordDao，提供借阅记录的CRUD操作
  - 实现与 BookCollectionEntity 的关联查询
  - 设计数据访问接口，支持借阅记录管理界面调用
  - _归属模块：藏书管理_
  - _需求: 8.2 - 借阅记录管理_

- [ ] 48. 实现借阅记录管理界面
  - 依赖任务45实现的借阅数据层，创建借阅记录管理界面
  - _需求: 8.2 - 借阅记录管理_

- [ ] 49. 实现心愿单管理功能
  - 创建心愿单界面和管理功能
  - 实现心愿单优先级管理和备注功能
  - _需求: 8.1 - 藏书管理界面_

- [ ] 50. 创建藏书展示和书单分享功能
  - 实现藏书展示界面
  - 添加书单创建和分享功能
  - _需求: 8.1 - 藏书管理界面_
  
- [ ] 51. 实现小部件功能

  - 实现书摘漫步小部件，随机展示用户的书摘
  - 实现今日阅读提醒小部件，提醒用户每日阅读计划
  - 支持小部件自定义配置（大小、样式等）
  - _需求: 用户体验优化_

## 🎁 P3 - 系统测试和发布准备

- [ ] 52. 系统测试

  - 端到端测试主要用户流程
  - 兼容性测试不同设备
  - 无障碍测试
  - _需求: 整体系统质量_

- [ ] 53. 应用发布准备
  - 配置应用签名和混淆
  - 优化 APK 大小和启动时间
  - 完善应用图标和启动页
  - 准备应用商店发布材料
  - _需求: 应用发布_
